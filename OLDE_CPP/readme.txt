this is OLDE's cpp version.